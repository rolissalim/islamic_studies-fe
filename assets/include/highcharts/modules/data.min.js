!function(a){var b,c=a.each,d=a.pick,e=HighchartsAdapter.inArray,f=a.splat,g=function(a,b){this.init(a,b)};a.extend(g.prototype,{init:function(a,b){this.options=a,this.chartOptions=b,this.columns=a.columns||this.rowsToColumns(a.rows)||[],this.firstRowAsNames=d(a.firstRowAsNames,!0),this.decimalRegex=a.decimalPoint&&RegExp("^([0-9]+)"+a.decimalPoint+"([0-9]+)$"),this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var d,e=this.chartOptions,f=this.options,g=[],h=function(b){return(a.seriesTypes[b||"line"].prototype.pointArrayMap||[0]).length},i=e&&e.chart&&e.chart.type,j=[],k=[],l=0;c(e&&e.series||[],function(a){j.push(h(a.type||i))}),c(f&&f.seriesMapping||[],function(a){g.push(a.x||0)}),0===g.length&&g.push(0),c(f&&f.seriesMapping||[],function(c){var f,g=new b,m=j[l]||h(i),n=a.seriesTypes[((e&&e.series||[])[l]||{}).type||i||"line"].prototype.pointArrayMap||["y"];g.addColumnReader(c.x,"x");for(f in c)c.hasOwnProperty(f)&&"x"!==f&&g.addColumnReader(c[f],f);for(d=0;d<m;d++)g.hasReader(n[d])||g.addColumnReader(void 0,n[d]);k.push(g),l++}),f=a.seriesTypes[i||"line"].prototype.pointArrayMap,void 0===f&&(f=["y"]),this.valueCount={global:h(i),xColumns:g,individual:j,seriesBuilders:k,globalPointArrayMap:f}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),!1!==this.parsed()&&this.complete()},parseCSV:function(){var a,b,d=this,e=this.options,f=e.csv,g=this.columns,h=e.startRow||0,i=e.endRow||Number.MAX_VALUE,j=e.startColumn||0,k=e.endColumn||Number.MAX_VALUE,l=0;f&&(b=f.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(e.lineDelimiter||"\n"),a=e.itemDelimiter||(-1!==f.indexOf("\t")?"\t":","),c(b,function(b,e){var f=d.trim(b),m=0===f.indexOf("#");e>=h&&e<=i&&!m&&""!==f&&(f=b.split(a),c(f,function(a,b){b>=j&&b<=k&&(g[b-j]||(g[b-j]=[]),g[b-j][l]=a)}),l+=1)}),this.dataFound())},parseTable:function(){var a=this.options,b=a.table,d=this.columns,e=a.startRow||0,f=a.endRow||Number.MAX_VALUE,g=a.startColumn||0,h=a.endColumn||Number.MAX_VALUE;b&&("string"==typeof b&&(b=document.getElementById(b)),c(b.getElementsByTagName("tr"),function(a,b){b>=e&&b<=f&&c(a.children,function(a,c){("TD"===a.tagName||"TH"===a.tagName)&&c>=g&&c<=h&&(d[c-g]||(d[c-g]=[]),d[c-g][b-e]=a.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var a,b,c=this,d=this.options,e=d.googleSpreadsheetKey,f=this.columns,g=d.startRow||0,h=d.endRow||Number.MAX_VALUE,i=d.startColumn||0,j=d.endColumn||Number.MAX_VALUE;e&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+e+"/"+(d.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:d.error,success:function(d){var e,k,d=d.feed.entry,l=d.length,m=0,n=0;for(k=0;k<l;k++)e=d[k],m=Math.max(m,e.gs$cell.col),n=Math.max(n,e.gs$cell.row);for(k=0;k<m;k++)k>=i&&k<=j&&(f[k-i]=[],f[k-i].length=Math.min(n,h-g));for(k=0;k<l;k++)e=d[k],a=e.gs$cell.row-1,(b=e.gs$cell.col-1)>=i&&b<=j&&a>=g&&a<=h&&(f[b-i][a-g]=e.content.$t);c.dataFound()}})},trim:function(a,b){return"string"==typeof a&&(a=a.replace(/^\s+|\s+$/g,""),b&&/^[0-9\s]+$/.test(a)&&(a=a.replace(/\s/g,"")),this.decimalRegex&&(a=a.replace(this.decimalRegex,"$1.$2"))),a},parseTypes:function(){for(var a=this.columns,b=a.length;b--;)this.parseColumn(a[b],b)},parseColumn:function(a,b){var c,d,g,h,i,j=this.rawColumns,k=this.columns,l=a.length,m=this.firstRowAsNames,n=-1!==e(b,this.valueCount.xColumns),o=[],p=this.chartOptions,q=(this.options.columnTypes||[])[b],p=n&&(p&&p.xAxis&&"category"===f(p.xAxis)[0].type||"string"===q);for(j[b]||(j[b]=[]);l--;)c=o[l]||a[l],g=this.trim(c),h=this.trim(c,!0),d=parseFloat(h),void 0===j[b][l]&&(j[b][l]=g),p||0===l&&m?a[l]=g:+h===d?(a[l]=d,d>31536e6&&"float"!==q?a.isDatetime=!0:a.isNumeric=!0,void 0!==a[l+1]&&(i=d>a[l+1])):(d=this.parseDate(c),n&&"number"==typeof d&&!isNaN(d)&&"float"!==q?(o[l]=c,a[l]=d,a.isDatetime=!0,void 0!==a[l+1]&&(c=d>a[l+1],c!==i&&void 0!==i&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,l=a.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):a.unsorted=!0),i=c)):(a[l]=""===g?null:g,0!==l&&(a.isDatetime||a.isNumeric)&&(a.mixed=!0)));if(n&&a.mixed&&(k[b]=j[b]),n&&i&&this.options.sort)for(b=0;b<k.length;b++)k[b].reverse(),m&&k[b].unshift(k[b].pop())},dateFormats:{"YYYY-mm-dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{2})[\-\/\.]([0-9]{2})$/,parser:function(a){return Date.UTC(+a[1],a[2]-1,+a[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(a){return Date.UTC(+a[3],a[2]-1,+a[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(a){return Date.UTC(+a[3],a[1]-1,+a[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(a){return Date.UTC(+a[3]+2e3,a[2]-1,+a[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(a){return Date.UTC(+a[3]+2e3,a[1]-1,+a[2])}}},parseDate:function(a){var b,c,d,e=this.options.parseDate,f=this.options.dateFormat||this.dateFormat;if(e)b=e(a);else if("string"==typeof a){if(f)e=this.dateFormats[f],(d=a.match(e.regex))&&(b=e.parser(d));else for(c in this.dateFormats)if(e=this.dateFormats[c],d=a.match(e.regex)){this.dateFormat=c,this.alternativeFormat=e.alternative,b=e.parser(d);break}d||(d=Date.parse(a),"object"==typeof d&&null!==d&&d.getTime?b=d.getTime()-6e4*d.getTimezoneOffset():"number"==typeof d&&!isNaN(d)&&(b=d-6e4*new Date(d).getTimezoneOffset()))}return b},rowsToColumns:function(a){var b,c,d,e,f;if(a)for(f=[],c=a.length,b=0;b<c;b++)for(e=a[b].length,d=0;d<e;d++)f[d]||(f[d]=[]),f[d][b]=a[b][d];return f},parsed:function(){if(this.options.parsed)return this.options.parsed.call(this,this.columns)},getFreeIndexes:function(a,b){var c,d,e,f=[],g=[];for(d=0;d<a;d+=1)f.push(!0);for(c=0;c<b.length;c+=1)for(e=b[c].getReferencedColumnIndexes(),d=0;d<e.length;d+=1)f[e[d]]=!1;for(d=0;d<f.length;d+=1)f[d]&&g.push(d);return g},complete:function(){var a,c,d,f,g,h,i=this.columns,j=this.options,k=[];if(j.complete||j.afterComplete){for(f=0;f<i.length;f++)this.firstRowAsNames&&(i[f].name=i[f].shift());for(c=[],d=this.getFreeIndexes(i.length,this.valueCount.seriesBuilders),f=0;f<this.valueCount.seriesBuilders.length;f++)h=this.valueCount.seriesBuilders[f],h.populateColumns(d)&&k.push(h);for(;d.length>0;){for(h=new b,h.addColumnReader(0,"x"),f=e(0,d),-1!==f&&d.splice(f,1),f=0;f<this.valueCount.global;f++)h.addColumnReader(void 0,this.valueCount.globalPointArrayMap[f]);h.populateColumns(d)&&k.push(h)}if(k.length>0&&k[0].readers.length>0&&void 0!==(h=i[k[0].readers[0].columnIndex])&&(h.isDatetime?a="datetime":h.isNumeric||(a="category")),"category"===a)for(f=0;f<k.length;f++)for(h=k[f],d=0;d<h.readers.length;d++)"x"===h.readers[d].configName&&(h.readers[d].configName="name");for(f=0;f<k.length;f++){for(h=k[f],d=[],g=0;g<i[0].length;g++)d[g]=h.read(i,g);c[f]={data:d},h.name&&(c[f].name=h.name),"category"===a&&(c[f].turboThreshold=0)}i={series:c},a&&(i.xAxis={type:a}),j.complete&&j.complete(i),j.afterComplete&&j.afterComplete(i)}}}),a.Data=g,a.data=function(a,b){return new g(a,b)},a.wrap(a.Chart.prototype,"init",function(b,c,d){var e=this;c&&c.data?a.data(a.extend(c.data,{afterComplete:function(f){var g,h;if(c.hasOwnProperty("series"))if("object"==typeof c.series)for(g=Math.max(c.series.length,f.series.length);g--;)h=c.series[g]||{},c.series[g]=a.merge(h,f.series[g]);else delete c.series;c=a.merge(f,c),b.call(e,c,d)}}),c):b.call(e,c,d)}),b=function(){this.readers=[],this.pointIsArray=!0},b.prototype.populateColumns=function(a){var b=!0;return c(this.readers,function(b){void 0===b.columnIndex&&(b.columnIndex=a.shift())}),c(this.readers,function(a){void 0===a.columnIndex&&(b=!1)}),b},b.prototype.read=function(a,b){var d,e=this.pointIsArray,f=e?[]:{};return c(this.readers,function(c){var d=a[c.columnIndex][b];e?f.push(d):f[c.configName]=d}),void 0===this.name&&this.readers.length>=2&&(d=this.getReferencedColumnIndexes(),d.length>=2)&&(d.shift(),d.sort(),this.name=a[d.shift()].name),f},b.prototype.addColumnReader=function(a,b){this.readers.push({columnIndex:a,configName:b}),"x"!==b&&"y"!==b&&void 0!==b&&(this.pointIsArray=!1)},b.prototype.getReferencedColumnIndexes=function(){var a,b,c=[];for(a=0;a<this.readers.length;a+=1)b=this.readers[a],void 0!==b.columnIndex&&c.push(b.columnIndex);return c},b.prototype.hasReader=function(a){var b,c;for(b=0;b<this.readers.length;b+=1)if(c=this.readers[b],c.configName===a)return!0}}(Highcharts);